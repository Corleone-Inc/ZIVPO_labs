# 1 Лабораторная Дзюба
Для анализа я взял образец, расположенный в Samples/Families/BackMyDataRansomware от 2025/07/09.
Я понял, что это локально ориентированный червь с механизмами обхода логических дисков, копирования себя на найденные тома и установления персистентности через реестр. 
Он содержит код для перебора процессов/модулей и широкое использование WinAPI для файловых операций, реестра и управления памятью. Сетевых вызовов  и явных криптокомпонентов в основном модуле не обнаружено, а основной вектор распространения локальный (съёмные носители или тома)

**Основные функции**

sub_401000 — главный цикл обнаружения логических дисков 

sub_401236 — обработка тома: проверка/копирование файла, установка атрибутов, возможность записи в реестр.

sub_4013** — работа с реестром: RegOpenKeyExW, RegSetValueExW — попытки автозапуска и персистентности. 

Процедуры перечисления процессов/модулей — используют CreateToolhelp32Snapshot / Process32NextW — для синхронизации экземпляров или поиска целей инжекции.

**Точка входа**
Точкой входа является функция, помеченная как sub_401000. Программа вызывает системный API GetLogicalDrives, получает битовую маску доступных логических томов и запускает итерацию по этой маске. Отсюда вытекает вся дальнейшая логика: образец не пытается сразу выйти в сеть или найти C2 — он сначала исследует файловую подсистему машины, выясняя, какие диски доступны для записи.

![функция sub_401000](https://github.com/Corleone-Inc/ZIVPO_labs/blob/main/Images/image.png)
**функция sub_401236**

Далее для каждого обнаруженного тома код формирует путь в явном виде — в листинге встречаются шаблоны и строки, соответствующие путям вида \\?\X:; после этого вызывается обработчик, который реализует логику проверки и записи. Практически сразу видно, что перед попыткой записи образец проверяет атрибуты существующего файла (вызов GetFileAttributesW), затем выполняет операцию копирования (CopyFileW) и, при успешном копировании, меняет атрибуты скопированного файла через SetFileAttributesW. 

Такая последовательность это проверка существования, попытка копирования себя на том же или съёмный носитель и маскировка атрибутов

в общем и целом принцип такой обнаружил диск → сформировал путь → проверил → скопировал → спрятал.

Параллельно с операциями над файлами в коде реализован механизм установки устойчивости. В одном из вспомогательных блоков (см. sub_401236 и соседние вызовы) программа открывает ключи реестра и записывает туда значения через RegOpenKeyExW и RegSetValueExW. Это не случайный импорт — вызовы расположены именно там, где формируются пути к скопированным файлам, и это типичный сценарий: после того как бинарник появился в целевом месте, он пытается прописать ссылку на себя в реестре, чтобы запускаться автоматически при старте системы. Именно совмещение операций копирования и записи в реестр в одном рабочем потоке показывает намерение создать персистентность, а не просто временную копию.
получает путь тома (например, \\?\X:), проверяет существование целевых файлов (GetFileAttributesW), копирует файл (CopyFileW) и в случае успеха пытается прописать данные в реестр (RegOpenKeyExW / RegSetValueExW) и изменить атрибуты файла (SetFileAttributesW). Иначе — пропускает.
![функция sub_401236](https://postimg.cc/mcbykkcp)
